DB = "phyloBlastDB.fa" #nr.gz database, downloaded May 10, 2018
SPECIES = ["Mphar_small"] #Protein fasta files have headers edited, according to AlexGa github (note that need to remove "cellular organisms")

rule all:
	input: expand("blastALL_{species}_final_ps_map.csv",species=SPECIES)

rule makeDB:
	output: "nr_ncbi.00.phr"
	shell: "makeblastdb -dbtype prot -in {DB}"

rule psMap:
	input: "nr_ncbi.00.phr",
			genomes="{species}_edit.fa",
	output: "blastALL_{species}_final_ps_map.csv"
	shell: "perl PSmap_HajkD.pl -i {input[genomes]} -d {DB} -p BLAST_{wildcards.species} -r {wildcards.species}.blast_results -t 30 -a 1"


